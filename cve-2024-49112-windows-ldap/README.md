Windows LDAP Zero-Click RCE
===========================

**Author:**    Hyperion Gray Security Research Team  
**Date:**      2025-11-16  
**CVE:**       [CVE-2024-49112](https://nvd.nist.gov/vuln/detail/CVE-2024-49112)  
**Advisory:**  https://socprime.com/blog/cve-2024-49112-exploitation-attempts-detection/  
**Tested on:** Windows Server 2019, 2022 (Domain Controllers)

Demo
----

_This is a skeleton exploit for research and educational purposes._

Discussion
----------

CVE-2024-49112 is a critical zero-click remote code execution vulnerability affecting 
Windows LDAP services on Domain Controllers. With a CVSS score of 9.8, this 
vulnerability represents a severe threat to Active Directory infrastructure.

The flaw allows attackers to:
- Execute arbitrary code on Windows Domain Controllers
- Gain SYSTEM-level privileges without authentication
- Compromise entire Active Directory domains
- Achieve exploitation with only Internet-connected DNS

**Attack Requirements:**
- Network access to LDAP service (typically port 389 or 636 for LDAPS)
- No user interaction or authentication required (zero-click)
- Target must be a Windows Domain Controller with LDAP service running

**Technical Details:**
The vulnerability exists in the Windows LDAP service's handling of specially crafted
LDAP requests. By sending malicious LDAP packets, an attacker can trigger a memory
corruption condition that leads to remote code execution. The zero-click nature makes
this especially dangerous as it requires no user interaction.

The attack can be launched from any network position where LDAP traffic can reach
the Domain Controller, making Internet-exposed DCs particularly vulnerable.

**Impact:**
- Complete domain compromise
- Credential theft from Active Directory
- Lateral movement to all domain-joined systems
- Persistent backdoor access to corporate networks

Usage
-----

This is a skeleton exploit demonstrating the attack structure. A fully working exploit
would require:

1. Deep understanding of Windows LDAP protocol implementation
2. Knowledge of LDAP packet structure and ASN.1 encoding
3. Memory corruption techniques specific to Windows LDAP service
4. Shellcode adapted for Windows Domain Controller environment
5. Reliable exploitation across different Windows Server versions

To use this skeleton:

    $ python3 exploit_skeleton.py TARGET_HOST

Where `TARGET_HOST` is the IP address or hostname of the Windows Domain Controller.

**Note:** This skeleton does NOT contain working exploitation code. It demonstrates
the attack structure and would require significant reverse engineering and testing
to create a functional exploit.

Mitigation
----------

- Apply Microsoft security updates immediately (November 2024 or later)
- Restrict LDAP service access to trusted networks only
- Never expose Domain Controllers directly to the Internet
- Monitor LDAP traffic for suspicious patterns
- Deploy SIEM rules for CVE-2024-49112 exploitation attempts
- Consider LDAP signing and channel binding enforcement

Detection
---------

SOC Prime provides Sigma detection rules for this CVE. Monitor for:
- Unusual LDAP request patterns
- LDAP requests with abnormal packet sizes
- Crashes in LDAP service (lsass.exe)
- Unexpected network connections from Domain Controllers

References
----------

- https://socprime.com/blog/cve-2024-49112-exploitation-attempts-detection/
- https://nvd.nist.gov/vuln/detail/CVE-2024-49112
- https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-49112
- SafeBreach Labs PoC disclosure
