Palo Alto PAN-OS Authentication Bypass
======================================

**Author:**    Hyperion Gray Security Research Team  
**Date:**      2025-11-16  
**CVE:**       [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)  
**Advisory:**  https://security.paloaltonetworks.com/CVE-2024-0012  
**Tested on:** PAN-OS 10.2, 11.0, 11.1, 11.2

Demo
----

_This is a skeleton exploit for research and educational purposes._

Discussion
----------

CVE-2024-0012 is a critical authentication bypass vulnerability affecting Palo Alto 
Networks PAN-OS management web interface. The vulnerability allows unauthenticated 
attackers to gain administrator privileges on affected firewalls.

The flaw allows attackers to:
- Bypass authentication checks by manipulating HTTP headers
- Gain full administrator access to the management interface
- Modify firewall configurations and security policies
- Chain with CVE-2024-9474 for privilege escalation to root

**Attack Requirements:**
- Network access to the management web interface (typically HTTPS port 443)
- No credentials or prior privileges required
- Management interface must be accessible to the attacker

**Technical Details:**
The vulnerability arises from improper authentication checks in the PAN-OS management 
web interface. By manipulating specific HTTP request headers (such as 
`X-PAN-AUTHCHECK: off`), attackers can bypass the normal authentication workflow 
and gain direct access to protected endpoints.

**Affected Products:**
- PA-Series firewalls
- VM-Series virtual firewalls
- CN-Series container firewalls
- Panorama appliances (M-Series and virtual)

**Not Affected:**
- Cloud NGFW
- Prisma Access

Usage
-----

This is a skeleton exploit demonstrating the attack structure. A fully working exploit
would require:

1. Specific knowledge of the target PAN-OS version
2. Identification of vulnerable endpoints
3. Proper header manipulation techniques
4. Post-exploitation modules for configuration changes

To use this skeleton:

    $ python3 exploit_skeleton.py TARGET_HOST

Where `TARGET_HOST` is the IP address or hostname of the PAN-OS management interface.

**Note:** This skeleton does NOT contain working exploitation code. It demonstrates
the attack structure and would require additional research and testing to create a 
functional exploit.

Mitigation
----------

- Upgrade to patched versions: 10.2.12-h2, 11.0.6-h1, 11.1.5-h1, 11.2.4-h1 or newer
- Restrict management interface access to trusted IP addresses only
- Never expose management interface to the internet
- Enable Threat Prevention signatures (IDs: 95746, 95747, 95752, 95753, 95759, 95763)
- If compromised, perform Enhanced Factory Reset

References
----------

- https://security.paloaltonetworks.com/CVE-2024-0012
- https://nvd.nist.gov/vuln/detail/CVE-2024-0012
- https://www.tenable.com/blog/cve-2024-0012-cve-2024-9474-zero-day-vulnerabilities-in-palo-alto-pan-os-exploited-in-the-wild
- https://www.wiz.io/vulnerability-database/cve/cve-2024-0012
