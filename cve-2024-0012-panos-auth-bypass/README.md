Palo Alto PAN-OS Authentication Bypass
======================================

**Author:**    Hyperion Gray Security Research Team  
**Date:**      2025-11-16  
**CVE:**       [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)  
**Advisory:**  https://security.paloaltonetworks.com/CVE-2024-0012  
**Tested on:** PAN-OS 10.2, 11.0, 11.1, 11.2

Demo
----

This exploit demonstrates authentication bypass with proper API interaction.
Uses benign read-only operations for research purposes.

Discussion
----------

CVE-2024-0012 is a critical authentication bypass vulnerability affecting Palo Alto 
Networks PAN-OS management web interface. The vulnerability allows unauthenticated 
attackers to gain administrator privileges on affected firewalls.

The exploit demonstrates:
- Fingerprinting PAN-OS version and configuration
- Authentication bypass using header manipulation
- API interaction to extract system information (read-only)
- Post-exploitation capabilities (theoretical)

**Attack Requirements:**
- Network access to the management web interface (typically HTTPS port 443)
- No credentials or prior privileges required
- Management interface must be accessible to the attacker

**Technical Details:**
The vulnerability arises from improper authentication checks in the PAN-OS management 
web interface. By manipulating specific HTTP request headers (such as 
`X-PAN-AUTHCHECK: off`), attackers can bypass the normal authentication workflow 
and gain direct access to protected endpoints.

**Affected Products:**
- PA-Series firewalls
- VM-Series virtual firewalls
- CN-Series container firewalls
- Panorama appliances (M-Series and virtual)

**Not Affected:**
- Cloud NGFW
- Prisma Access

Usage
-----

    $ python3 exploit_skeleton.py TARGET_URL

Where `TARGET_URL` is the HTTPS URL of the PAN-OS management interface.

Example:

    $ python3 exploit_skeleton.py https://192.168.1.1

The exploit will:
1. Fingerprint the target to confirm it's PAN-OS
2. Attempt authentication bypass using header manipulation
3. Try to access version API endpoint (read-only, safe)
4. Display system information if bypass is successful
5. Show theoretical post-exploitation capabilities

**Note:** This uses benign read-only operations for research. A weaponized version
could modify configurations, create backdoors, or extract sensitive data.

Mitigation
----------

- Upgrade to patched versions: 10.2.12-h2, 11.0.6-h1, 11.1.5-h1, 11.2.4-h1 or newer
- Restrict management interface access to trusted IP addresses only
- Never expose management interface to the internet
- Enable Threat Prevention signatures (IDs: 95746, 95747, 95752, 95753, 95759, 95763)
- If compromised, perform Enhanced Factory Reset

References
----------

- https://security.paloaltonetworks.com/CVE-2024-0012
- https://nvd.nist.gov/vuln/detail/CVE-2024-0012
- https://www.tenable.com/blog/cve-2024-0012-cve-2024-9474-zero-day-vulnerabilities-in-palo-alto-pan-os-exploited-in-the-wild
- https://www.wiz.io/vulnerability-database/cve/cve-2024-0012
